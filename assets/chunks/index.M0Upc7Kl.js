import{i as J,p as O}from"./index.C7-Tf2T7.js";function _(t,r,e){if(t!==null)for(var n,i,a,l,S,s,M,w=0,u=0,P,W=t.type,E=W==="FeatureCollection",z=W==="Feature",F=E?t.features.length:1,f=0;f<F;f++){M=E?t.features[f].geometry:z?t.geometry:t,P=M?M.type==="GeometryCollection":!1,S=P?M.geometries.length:1;for(var G=0;G<S;G++){var c=0,h=0;if(l=P?M.geometries[G]:M,l!==null){s=l.coordinates;var p=l.type;switch(w=0,p){case null:break;case"Point":if(r(s,u,f,c,h)===!1)return!1;u++,c++;break;case"LineString":case"MultiPoint":for(n=0;n<s.length;n++){if(r(s[n],u,f,c,h)===!1)return!1;u++,p==="MultiPoint"&&c++}p==="LineString"&&c++;break;case"Polygon":case"MultiLineString":for(n=0;n<s.length;n++){for(i=0;i<s[n].length-w;i++){if(r(s[n][i],u,f,c,h)===!1)return!1;u++}p==="MultiLineString"&&c++,p==="Polygon"&&h++}p==="Polygon"&&c++;break;case"MultiPolygon":for(n=0;n<s.length;n++){for(h=0,i=0;i<s[n].length;i++){for(a=0;a<s[n][i].length-w;a++){if(r(s[n][i][a],u,f,c,h)===!1)return!1;u++}h++}c++}break;case"GeometryCollection":for(n=0;n<l.geometries.length;n++)if(_(l.geometries[n],r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function T(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return L(t);case"FeatureCollection":return U(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return m(t);default:throw new Error("unknown GeoJSON type")}}function L(t){const r={type:"Feature"};return Object.keys(t).forEach(e=>{switch(e){case"type":case"properties":case"geometry":return;default:r[e]=t[e]}}),r.properties=N(t.properties),t.geometry==null?r.geometry=null:r.geometry=m(t.geometry),r}function N(t){const r={};return t&&Object.keys(t).forEach(e=>{const n=t[e];typeof n=="object"?n===null?r[e]=null:Array.isArray(n)?r[e]=n.map(i=>i):r[e]=N(n):r[e]=n}),r}function U(t){const r={type:"FeatureCollection"};return Object.keys(t).forEach(e=>{switch(e){case"type":case"features":return;default:r[e]=t[e]}}),r.features=t.features.map(e=>L(e)),r}function m(t){const r={type:t.type};return t.bbox&&(r.bbox=t.bbox),t.type==="GeometryCollection"?(r.geometries=t.geometries.map(e=>m(e)),r):(r.coordinates=D(t.coordinates),r)}function D(t){const r=t;return typeof r[0]!="object"?r.slice():r.map(e=>D(e))}function H(t,r={}){return R(t,"mercator",r)}function K(t,r={}){return R(t,"wgs84",r)}function R(t,r,e={}){e=e||{};var n=e.mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&J(t[0])?t=r==="mercator"?d(t):q(t):(n!==!0&&(t=T(t)),_(t,function(i){var a=r==="mercator"?d(i):q(i);i[0]=a[0],i[1]=a[1]})),t}function d(t){var r=Math.PI/180,e=6378137,n=20037508342789244e-9,i=Math.abs(t[0])<=180?t[0]:t[0]-Q(t[0])*360,a=[e*i*r,e*Math.log(Math.tan(Math.PI*.25+.5*t[1]*r))];return a[0]>n&&(a[0]=n),a[0]<-20037508342789244e-9&&(a[0]=-20037508342789244e-9),a[1]>n&&(a[1]=n),a[1]<-20037508342789244e-9&&(a[1]=-20037508342789244e-9),a}function q(t){var r=180/Math.PI,e=6378137;return[t[0]*r/e,(Math.PI*.5-2*Math.atan(Math.exp(-t[1]/e)))*r]}function Q(t){return t<0?-1:t>0?1:0}const o=Math.PI,A=6378245,B=.006693421622965943,v=o*3e3/180;function X([t,r]){return t<72.004||t>137.8347?!0:r<.8293||r>55.8271}function k([t,r]){let e=V(t-105,r-35),n=Y(t-105,r-35);const i=r/180*o;let a=Math.sin(i);a=1-B*a*a;const l=Math.sqrt(a);return e=e*180/(A*(1-B)/(a*l)*o),n=n*180/(A/l*Math.cos(i)*o),[n,e]}function V(t,r){let e=-100+2*t+3*r+.2*r*r+.1*t*r+.2*Math.sqrt(Math.abs(t));return e+=(20*Math.sin(6*t*o)+20*Math.sin(2*t*o))*2/3,e+=(20*Math.sin(r*o)+40*Math.sin(r/3*o))*2/3,e+=(160*Math.sin(r/12*o)+320*Math.sin(r*o/30))*2/3,e}function Y(t,r){let e=300+t+2*r+.1*t*t+.1*t*r+.1*Math.sqrt(Math.abs(t));return e+=(20*Math.sin(6*t*o)+20*Math.sin(2*t*o))*2/3,e+=(20*Math.sin(t*o)+40*Math.sin(t/3*o))*2/3,e+=(150*Math.sin(t/12*o)+300*Math.sin(t/30*o))*2/3,e}const g={toWgs84:t=>{const r=K(O(t)).geometry.coordinates;return[r[0],r[1]]},toGcj02:t=>y.toGcj02(g.toWgs84(t)),toBd09:t=>b.toBd09(g.toGcj02(t))},y={toMerc:t=>H(O(t)).geometry.coordinates,toGcj02:([t,r])=>{if(!X([t,r])){const[e,n]=k([t,r]);t+=e,r+=n}return[t,r]},toBd09:t=>b.toBd09(y.toGcj02(t))},b={toWgs84:([t,r])=>{if(!X([t,r])){const[e,n]=k([t,r]);t-=e,r-=n}return[t,r]},toBd09:([t,r])=>{let e=t,n=r;const i=Math.sqrt(e*e+n*n)+2e-5*Math.sin(n*v),a=Math.atan2(n,e)+3e-6*Math.cos(e*v);return e=i*Math.cos(a)+.0065,n=i*Math.sin(a)+.006,[e,n]},toMerc:t=>y.toMerc(b.toWgs84(t))},C={toWgs84:t=>b.toWgs84(C.toGcj02(t)),toGcj02:([t,r])=>{let e=t-.0065,n=r-.006;const i=Math.sqrt(e*e+n*n)-2e-5*Math.sin(n*v),a=Math.atan2(n,e)-3e-6*Math.cos(e*v);return e=i*Math.cos(a),n=i*Math.sin(a),[e,n]},toMerc:t=>y.toMerc(C.toWgs84(t))},$=Object.freeze(Object.defineProperty({__proto__:null,bd09:C,gcj02:b,merc:g,wgs84:y},Symbol.toStringTag,{value:"Module"}));export{y as M,$ as t};
